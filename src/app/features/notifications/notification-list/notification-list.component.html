<div class="notification-container">
  <div class="header">
    <h1>Central de Notificações</h1>
    <div class="header-actions">
      <mat-chip
        [matBadge]="notificationService.unreadCount()"
        matBadgeColor="warn"
      >
        {{ notificationService.unreadCount() }} não lidas
      </mat-chip>
      <button
        mat-raised-button
        color="primary"
        (click)="markAllAsRead()"
        [disabled]="notificationService.unreadCount() === 0"
      >
        Marcar Todas como Lidas
      </button>
    </div>
  </div>

  @if (notificationService.notifications().length === 0) {
    <mat-card class="empty-state">
      <mat-card-content>
        <mat-icon class="empty-icon">notifications</mat-icon>
        <h2>Nenhuma notificação</h2>
        <p>Você está em dia com todas as informações!</p>
      </mat-card-content>
    </mat-card>
  } @else {
    <div class="notifications-list">
      @for (
        notification of notificationService.notifications();
        track notification.id
      ) {
        <mat-card
          class="notification-card"
          [class.unread]="!notification.isRead"
        >
          <mat-card-header>
            <mat-icon
              mat-card-avatar
              [class]="getNotificationIconClass(notification.type)"
            >
              {{ getNotificationIcon(notification.type) }}
            </mat-icon>
            <mat-card-title>{{ notification.title }}</mat-card-title>
            <mat-card-subtitle>
              {{ notification.createdAt | date: "dd/MM/yyyy HH:mm" }}
              @if (!notification.isRead) {
                <mat-chip color="white" class="unread-chip">
                  <span class="chip-white">Nova</span>
                </mat-chip>
              }
            </mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <p>{{ notification.message }}</p>
          </mat-card-content>

          <mat-card-actions>
            @if (!notification.isRead) {
              <button mat-button (click)="markAsRead(notification.id)">
                <mat-icon>check</mat-icon>
                Marcar como Lida
              </button>
            }

            <button
              mat-button
              color="warn"
              (click)="deleteNotification(notification.id)"
            >
              <mat-icon>delete</mat-icon>
              Excluir
            </button>
          </mat-card-actions>
        </mat-card>
      }
    </div>
  }
</div>
