@if (playerReport) {
  <div class="player-report-container">
    <div class="header">
      <button mat-icon-button (click)="goBack()" class="back-button">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <h1>Relatório do Jogador</h1>
    </div>

    <mat-card class="player-info-card">
      <mat-card-content>
        <div class="player-header">
          <div class="player-details">
            <h2>{{ playerReport.player.name }}</h2>
            <p>{{ playerReport.team.name }} • {{ playerReport.player.position }}</p>
            <p>Número {{ playerReport.player.number }} • {{ playerReport.player.age }} anos</p>
          </div>
          <div class="performance-rating">
            <div class="rating-circle" [style.background]="getRatingColor()">
              <span class="rating-value">{{ playerReport.performanceRating.toFixed(1) }}</span>
            </div>
            <span class="rating-label">Avaliação</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <div class="stats-grid">
      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-item">
            <mat-icon class="stat-icon goals">sports_soccer</mat-icon>
            <div class="stat-content">
              <span class="stat-value">{{ playerReport.player.statistics.goals }}</span>
              <span class="stat-label">Gols</span>
              <span class="stat-detail">{{ playerReport.averageGoalsPerMatch.toFixed(2) }} por jogo</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-item">
            <mat-icon class="stat-icon assists">assistant</mat-icon>
            <div class="stat-content">
              <span class="stat-value">{{ playerReport.player.statistics.assists }}</span>
              <span class="stat-label">Assistências</span>
              <span class="stat-detail">{{ playerReport.averageAssistsPerMatch.toFixed(2) }} por jogo</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-item">
            <mat-icon class="stat-icon matches">timer</mat-icon>
            <div class="stat-content">
              <span class="stat-value">{{ playerReport.player.statistics.matches }}</span>
              <span class="stat-label">Partidas</span>
              <span class="stat-detail">{{ playerReport.player.statistics.minutesPlayed }} min</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-item">
            <mat-icon class="stat-icon discipline" [style.color]="getDisciplineColor()">credit_card</mat-icon>
            <div class="stat-content">
              <span class="stat-value">{{ getTotalCards() }}</span>
              <span class="stat-label">Cartões</span>
              <span class="stat-detail">{{ playerReport.disciplinaryRecord }}</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <mat-card class="detailed-stats-card">
      <mat-card-header>
        <mat-card-title>Estatísticas Detalhadas</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detailed-stats">
          <div class="stat-group">
            <h3>Desempenho Ofensivo</h3>
            <div class="stat-row">
              <span>Total de Gols:</span>
              <strong>{{ playerReport.player.statistics.goals }}</strong>
            </div>
            <div class="stat-row">
              <span>Total de Assistências:</span>
              <strong>{{ playerReport.player.statistics.assists }}</strong>
            </div>
            <div class="stat-row">
              <span>Participações em Gols:</span>
              <strong>{{ playerReport.player.statistics.goals + playerReport.player.statistics.assists }}</strong>
            </div>
            <div class="stat-row">
              <span>Média por Partida:</span>
              <strong>{{ getGoalContributionAverage() }}</strong>
            </div>
          </div>

          <div class="stat-group">
            <h3>Disciplina</h3>
            <div class="stat-row">
              <span>Cartões Amarelos:</span>
              <strong class="yellow">{{ playerReport.player.statistics.yellowCards }}</strong>
            </div>
            <div class="stat-row">
              <span>Cartões Vermelhos:</span>
              <strong class="red">{{ playerReport.player.statistics.redCards }}</strong>
            </div>
            <div class="stat-row">
              <span>Registro Disciplinar:</span>
              <strong [style.color]="getDisciplineColor()">{{ playerReport.disciplinaryRecord }}</strong>
            </div>
          </div>

          <div class="stat-group">
            <h3>Tempo de Jogo</h3>
            <div class="stat-row">
              <span>Partidas Jogadas:</span>
              <strong>{{ playerReport.player.statistics.matches }}</strong>
            </div>
            <div class="stat-row">
              <span>Minutos Totais:</span>
              <strong>{{ playerReport.player.statistics.minutesPlayed }}</strong>
            </div>
            <div class="stat-row">
              <span>Média por Jogo:</span>
              <strong>{{ getAverageMinutes() }} min</strong>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <div class="action-buttons">
      <button mat-raised-button color="primary" (click)="exportReport()">
        <mat-icon>file_download</mat-icon>
        Exportar PDF
      </button>
      <button mat-raised-button (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
        Voltar
      </button>
    </div>
  </div>
} @else {
  <div class="loading">
    <mat-icon>hourglass_empty</mat-icon>
    <p>Carregando relatório do jogador...</p>
  </div>
}
